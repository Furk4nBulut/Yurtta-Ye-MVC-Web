@using Microsoft.AspNetCore.Identity
@using Microsoft.Extensions.Localization
@using Microsoft.AspNetCore.Mvc.Localization
@inject SignInManager<IdentityUser> SignInManager
@inject UserManager<IdentityUser> UserManager
@inject IViewLocalizer Localizer

@{
    var currentCulture = System.Threading.Thread.CurrentThread.CurrentUICulture.Name;
    var isTr = currentCulture.StartsWith("tr");
    var isEn = currentCulture.StartsWith("en");
}

<!-- Navbar -->
<header x-data="{ navOpen: false }" class="navbar sticky top-0 z-50">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="relative flex items-center justify-between py-3">

            <!-- Left Icons -->
            <div class="flex items-center space-x-2">
                <a href="https://play.google.com/store/apps/details?id=com.yurttaye.yurttaye" target="_blank" class="nav-link p-2 lg:px-4 lg:py-2" title="@Localizer["DownloadOnGooglePlay"]">
                    <i class="fab fa-google-play text-xl"></i>
                    <span class="hidden lg:inline ml-2 font-semibold">@Localizer["DownloadOnGooglePlay"]</span>
                </a>
                <a href="@Url.Action("SetLanguage", "Home", new { culture = (isTr ? "en" : "tr"), returnUrl = Context.Request.Path + Context.Request.QueryString })" class="nav-link p-2 lg:px-4 lg:py-2" title="@Localizer["ChangeLanguage"]">
                    <i class="fas fa-language text-xl"></i>
                    <span class="hidden lg:inline ml-2 font-semibold">@Localizer["ChangeLanguage"]</span>
                </a>
            </div>

            <!-- Centered Brand (All screens) -->
            <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2">
                <a class="brand" href="/">YurttaYe</a>
            </div>

            <!-- Right Icons -->
            <div class="flex items-center space-x-2">
                <button x-on:click="darkMode = !darkMode; localStorage.setItem('darkMode', darkMode)" class="nav-action-icon p-2 lg:px-4 lg:py-2" aria-label="@Localizer["ToggleTheme"]">
                    <i x-show="!darkMode" class="fas fa-sun text-xl"></i>
                    <span class="hidden lg:inline ml-2 font-semibold" x-show="!darkMode">@Localizer["LightMode"]</span>
                    <i x-show="darkMode" class="fas fa-moon text-xl"></i>
                    <span class="hidden lg:inline ml-2 font-semibold" x-show="darkMode">@Localizer["DarkMode"]</span>
                </button>
                <div class="hidden lg:flex items-center">
                    @if (User.Identity?.IsAuthenticated ?? false)
                    {
                        <a class="nav-action-icon p-2 lg:px-4 lg:py-2" asp-controller="Account" asp-action="Logout" title="@Localizer["Logout"]">
                            <i class="fas fa-sign-out-alt text-xl"></i>
                            <span class="hidden lg:inline ml-2 font-semibold">@Localizer["Logout"]</span>
                        </a>
                    }
                    else
                    {
                        <a class="nav-action-icon p-2 lg:px-4 lg:py-2" asp-controller="Account" asp-action="Login" title="@Localizer["Login"]">
                            <i class="fas fa-sign-in-alt text-xl"></i>
                            <span class="hidden lg:inline ml-2 font-semibold">@Localizer["Login"]</span>
                        </a>
                    }
                </div>
                <!-- Mobile Menu Toggle -->
                <button x-on:click="navOpen = !navOpen" class="nav-action-icon lg:hidden p-2" aria-label="Menüyü aç/kapat">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Mobile Menu Panel-->
    <div x-show="navOpen" x-on:click.away="navOpen = false" class="lg:hidden border-t border-white/10" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0 -translate-y-4" x-transition:enter-end="opacity-100 translate-y-0" x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100 translate-y-0" x-transition:leave-end="opacity-0 -translate-y-4">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <ul class="flex flex-col space-y-2">
                <li><a class="nav-link !w-full !justify-start" asp-controller="Home" asp-action="Index"><i class="fas fa-home text-xl w-8 text-center mr-3"></i>@Localizer["HomePage"]</a></li>
                <li><a class="nav-link !w-full !justify-start" href="https://play.google.com/store/apps/details?id=com.yurttaye.yurttaye" target="_blank"><i class="fab fa-google-play text-xl w-8 text-center mr-3"></i>@Localizer["DownloadOnGooglePlay"]</a></li>
                <li>
                    <a href="@Url.Action("SetLanguage", "Home", new { culture = (isTr ? "en" : "tr"), returnUrl = Context.Request.Path + Context.Request.QueryString })" class="nav-link !w-full !justify-start">
                        <i class="fas fa-language text-xl w-8 text-center mr-3"></i>@Localizer["ChangeLanguage"]
                    </a>
                </li>
                @if (User.IsInRole("Admin"))
                {
                    <li><a class="nav-link !w-full !justify-start" asp-area="Admin" asp-controller="AdminMenu" asp-action="Index"><i class="fas fa-user-shield text-xl w-8 text-center mr-3"></i>@Localizer["Management"]</a></li>
                }
                @if (User.Identity?.IsAuthenticated ?? false)
                {
                    <li><a class="nav-link !w-full !justify-start" asp-controller="Account" asp-action="Logout"><i class="fas fa-sign-out-alt text-xl w-8 text-center mr-3"></i>@Localizer["Logout"]</a></li>
                }
                else
                {
                    <li><a class="nav-link !w-full !justify-start" asp-controller="Account" asp-action="Login"><i class="fas fa-sign-in-alt text-xl w-8 text-center mr-3"></i>@Localizer["Login"]</a></li>
                }
            </ul>
        </div>
    </div>
</header> 